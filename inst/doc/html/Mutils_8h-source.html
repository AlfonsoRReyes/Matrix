<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Matrix: Mutils.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">src</a></div>
<h1>Mutils.h</h1><a href="Mutils_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#ifndef MATRIX_MUTILS_H</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define MATRIX_MUTILS_H</span>
00003 <span class="preprocessor"></span>
00004 <span class="preprocessor">#ifdef __cplusplus</span>
00005 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00006 <span class="preprocessor">#endif</span>
00007 <span class="preprocessor"></span>    
00008 <span class="preprocessor">#include &lt;Rdefines.h&gt;</span>
00009 <span class="preprocessor">#include &lt;Rconfig.h&gt;</span>
00010 <span class="preprocessor">#include &lt;R.h&gt;</span>  <span class="comment">/* to include Rconfig.h */</span>
00011     
00012 <span class="preprocessor">#ifdef ENABLE_NLS</span>
00013 <span class="preprocessor"></span><span class="preprocessor">#include &lt;libintl.h&gt;</span>
<a name="l00014"></a><a class="code" href="Mutils_8h.html#a0">00014</a> <span class="preprocessor">#define _(String) dgettext ("Matrix", String)</span>
00015 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00016 <span class="preprocessor"></span><span class="preprocessor">#define _(String) (String)</span>
00017 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00018 <span class="preprocessor"></span>    
00019 <span class="comment">/* enum constants from cblas.h and some short forms */</span>
<a name="l00020"></a><a class="code" href="Mutils_8h.html#a59">00020</a> <span class="keyword">enum</span> <a class="code" href="Mutils_8h.html#a59">CBLAS_ORDER</a> {<a class="code" href="Mutils_8h.html#a59a14">CblasRowMajor</a>=101, <a class="code" href="Mutils_8h.html#a59a15">CblasColMajor</a>=102};
<a name="l00021"></a><a class="code" href="Mutils_8h.html#a60">00021</a> <span class="keyword">enum</span> <a class="code" href="Mutils_8h.html#a60">CBLAS_TRANSPOSE</a> {<a class="code" href="Mutils_8h.html#a60a16">CblasNoTrans</a>=111, <a class="code" href="Mutils_8h.html#a60a17">CblasTrans</a>=112, <a class="code" href="Mutils_8h.html#a60a18">CblasConjTrans</a>=113};
<a name="l00022"></a><a class="code" href="Mutils_8h.html#a61">00022</a> <span class="keyword">enum</span> <a class="code" href="Mutils_8h.html#a61">CBLAS_UPLO</a> {<a class="code" href="Mutils_8h.html#a61a19">CblasUpper</a>=121, <a class="code" href="Mutils_8h.html#a61a20">CblasLower</a>=122};
<a name="l00023"></a><a class="code" href="Mutils_8h.html#a62">00023</a> <span class="keyword">enum</span> <a class="code" href="Mutils_8h.html#a62">CBLAS_DIAG</a> {<a class="code" href="Mutils_8h.html#a62a21">CblasNonUnit</a>=131, <a class="code" href="Mutils_8h.html#a62a22">CblasUnit</a>=132};
<a name="l00024"></a><a class="code" href="Mutils_8h.html#a63">00024</a> <span class="keyword">enum</span> <a class="code" href="Mutils_8h.html#a63">CBLAS_SIDE</a> {<a class="code" href="Mutils_8h.html#a63a23">CblasLeft</a>=141, <a class="code" href="Mutils_8h.html#a63a24">CblasRight</a>=142};
<a name="l00025"></a><a class="code" href="Mutils_8h.html#a1">00025</a> <span class="preprocessor">#define RMJ CblasRowMajor</span>
<a name="l00026"></a><a class="code" href="Mutils_8h.html#a2">00026</a> <span class="preprocessor"></span><span class="preprocessor">#define CMJ CblasColMajor</span>
<a name="l00027"></a><a class="code" href="Mutils_8h.html#a3">00027</a> <span class="preprocessor"></span><span class="preprocessor">#define NTR CblasNoTrans</span>
<a name="l00028"></a><a class="code" href="Mutils_8h.html#a4">00028</a> <span class="preprocessor"></span><span class="preprocessor">#define TRN CblasTrans</span>
<a name="l00029"></a><a class="code" href="Mutils_8h.html#a5">00029</a> <span class="preprocessor"></span><span class="preprocessor">#define CTR CblasConjTrans</span>
<a name="l00030"></a><a class="code" href="Mutils_8h.html#a6">00030</a> <span class="preprocessor"></span><span class="preprocessor">#define UPP CblasUpper</span>
<a name="l00031"></a><a class="code" href="Mutils_8h.html#a7">00031</a> <span class="preprocessor"></span><span class="preprocessor">#define LOW CblasLower</span>
<a name="l00032"></a><a class="code" href="Mutils_8h.html#a8">00032</a> <span class="preprocessor"></span><span class="preprocessor">#define NUN CblasNonUnit</span>
<a name="l00033"></a><a class="code" href="Mutils_8h.html#a9">00033</a> <span class="preprocessor"></span><span class="preprocessor">#define UNT CblasUnit</span>
<a name="l00034"></a><a class="code" href="Mutils_8h.html#a10">00034</a> <span class="preprocessor"></span><span class="preprocessor">#define LFT CblasLeft</span>
<a name="l00035"></a><a class="code" href="Mutils_8h.html#a11">00035</a> <span class="preprocessor"></span><span class="preprocessor">#define RGT CblasRight</span>
00036 <span class="preprocessor"></span>
00037 <span class="keywordtype">char</span> <a class="code" href="Mutils_8c.html#a2">norm_type</a>(<span class="keywordtype">char</span> *typstr);
00038 <span class="keywordtype">char</span> <a class="code" href="Mutils_8c.html#a3">rcond_type</a>(<span class="keywordtype">char</span> *typstr);
00039 <span class="keywordtype">double</span> <a class="code" href="Mutils_8c.html#a4">get_double_by_name</a>(SEXP obj, <span class="keywordtype">char</span> *nm);
00040 SEXP <a class="code" href="Mutils_8c.html#a5">set_double_by_name</a>(SEXP obj, <span class="keywordtype">double</span> val, <span class="keywordtype">char</span> *nm);
00041 SEXP <a class="code" href="Mutils_8c.html#a6">as_det_obj</a>(<span class="keywordtype">double</span> val, <span class="keywordtype">int</span> log, <span class="keywordtype">int</span> sign);
00042 SEXP <a class="code" href="Mutils_8c.html#a7">get_factors</a>(SEXP obj, <span class="keywordtype">char</span> *nm);
00043 SEXP <a class="code" href="Mutils_8c.html#a8">set_factors</a>(SEXP obj, SEXP val, <span class="keywordtype">char</span> *nm);
00044 SEXP <a class="code" href="Mutils_8c.html#a9">dgCMatrix_set_Dim</a>(SEXP x, <span class="keywordtype">int</span> nrow);
00045 <span class="keywordtype">int</span> <a class="code" href="Mutils_8c.html#a10">csc_unsorted_columns</a>(<span class="keywordtype">int</span> ncol, <span class="keyword">const</span> <span class="keywordtype">int</span> p[], <span class="keyword">const</span> <span class="keywordtype">int</span> i[]);
00046 <span class="keywordtype">void</span> <a class="code" href="Mutils_8c.html#a11">csc_sort_columns</a>(<span class="keywordtype">int</span> ncol, <span class="keyword">const</span> <span class="keywordtype">int</span> p[], <span class="keywordtype">int</span> i[], <span class="keywordtype">double</span> x[]);
00047 SEXP <a class="code" href="Mutils_8c.html#a13">triple_as_SEXP</a>(<span class="keywordtype">int</span> nrow, <span class="keywordtype">int</span> ncol, <span class="keywordtype">int</span> nz,
00048                     <span class="keyword">const</span> <span class="keywordtype">int</span> Ti [], <span class="keyword">const</span> <span class="keywordtype">int</span> Tj [], <span class="keyword">const</span> <span class="keywordtype">double</span> Tx [],
00049                     <span class="keywordtype">char</span> *Rclass);
00050 SEXP <a class="code" href="Mutils_8c.html#a12">csc_check_column_sorting</a>(SEXP A);
00051 <span class="keywordtype">void</span> <a class="code" href="Mutils_8c.html#a14">csc_compTr</a>(<span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> nnz,
00052                 <span class="keyword">const</span> <span class="keywordtype">int</span> xp[], <span class="keyword">const</span> <span class="keywordtype">int</span> xi[], <span class="keyword">const</span> <span class="keywordtype">double</span> xx[],
00053                 <span class="keywordtype">int</span> ap[], <span class="keywordtype">int</span> ai[], <span class="keywordtype">double</span> ax[]);
00054 <span class="keywordtype">void</span> <a class="code" href="Mutils_8c.html#a15">ssc_symbolic_permute</a>(<span class="keywordtype">int</span> n, <span class="keywordtype">int</span> upper, <span class="keyword">const</span> <span class="keywordtype">int</span> perm[],
00055                           <span class="keywordtype">int</span> Ap[], <span class="keywordtype">int</span> Ai[]);
00056 <span class="keywordtype">double</span> *<a class="code" href="Mutils_8c.html#a16">nlme_symmetrize</a>(<span class="keywordtype">double</span> *a, <span class="keyword">const</span> <span class="keywordtype">int</span> nc);
00057 <span class="keywordtype">void</span> <a class="code" href="Mutils_8c.html#a17">nlme_check_Lapack_error</a>(<span class="keywordtype">int</span> info, <span class="keyword">const</span> <span class="keywordtype">char</span> *laName);
00058 SEXP <a class="code" href="Mutils_8c.html#a19">nlme_replaceSlot</a>(SEXP obj, SEXP names, SEXP value);
00059 SEXP <a class="code" href="Mutils_8c.html#a20">nlme_weight_matrix_list</a>(SEXP MLin, SEXP wts, SEXP adjst, SEXP MLout);
00060 SEXP <a class="code" href="Mutils_8c.html#a21">Matrix_make_named</a>(<span class="keywordtype">int</span> TYP, <span class="keywordtype">char</span> **names);
00061 SEXP <a class="code" href="Mutils_8c.html#a24">check_scalar_string</a>(SEXP sP, <span class="keywordtype">char</span> *vals, <span class="keywordtype">char</span> *nm);
00062 <span class="keywordtype">double</span> *<a class="code" href="Mutils_8c.html#a25">packed_to_full</a>(<span class="keywordtype">double</span> *dest, <span class="keyword">const</span> <span class="keywordtype">double</span> *src, <span class="keywordtype">int</span> n,
00063                        <span class="keyword">enum</span> CBLAS_UPLO uplo);
00064 <span class="keywordtype">double</span> *<a class="code" href="Mutils_8c.html#a26">full_to_packed</a>(<span class="keywordtype">double</span> *dest, <span class="keyword">const</span> <span class="keywordtype">double</span> *src, <span class="keywordtype">int</span> n,
00065                        <span class="keyword">enum</span> CBLAS_UPLO uplo, <span class="keyword">enum</span> CBLAS_DIAG diag);
00066 <span class="keywordtype">double</span> *<a class="code" href="Mutils_8c.html#a27">packed_getDiag</a>(<span class="keywordtype">double</span> *dest, SEXP x);
00067 
00068 <span class="keyword">extern</span>   <span class="comment">/* stored pointers to symbols initialized in R_init_Matrix */</span>
00069 <span class="preprocessor">#include "<a class="code" href="Syms_8h.html">Syms.h</a>"</span>
00070 
00071 <span class="comment">/* zero an array */</span>
<a name="l00072"></a><a class="code" href="Mutils_8h.html#a12">00072</a> <span class="preprocessor">#define AZERO(x, n) {int _I_, _SZ_ = (n); for(_I_ = 0; _I_ &lt; _SZ_; _I_++) (x)[_I_] = 0;}</span>
00073 <span class="preprocessor"></span>
00074 <span class="comment">/* number of elements in one triangle of a square matrix of order n */</span>
<a name="l00075"></a><a class="code" href="Mutils_8h.html#a13">00075</a> <span class="preprocessor">#define PACKED_LENGTH(n)   ((n) * ((n) + 1))/2</span>
00076 <span class="preprocessor"></span>
00085 <span class="keyword">static</span> R_INLINE
<a name="l00086"></a><a class="code" href="Mutils_8h.html#a48">00086</a> <span class="keywordtype">int</span> <a class="code" href="Mutils_8h.html#a48">packed_ncol</a>(<span class="keywordtype">int</span> len) 
00087 {
00088     <span class="keywordtype">int</span> disc = 8 * len + 1;     <span class="comment">/* discriminant */</span>
00089     <span class="keywordtype">int</span> sqrtd = (int) sqrt((<span class="keywordtype">double</span>) disc);
00090 
00091     <span class="keywordflow">if</span> (len &lt; 0 || disc != sqrtd * sqrtd)
00092         error(<a class="code" href="Mutils_8h.html#a0">_</a>(<span class="stringliteral">"invalid 'len' = %d in packed_ncol"</span>));
00093     <span class="keywordflow">return</span> (sqrtd - 1)/2;
00094 }
00095 
00111 <span class="keyword">static</span> R_INLINE
<a name="l00112"></a><a class="code" href="Mutils_8h.html#a49">00112</a> SEXP <a class="code" href="Mutils_8h.html#a49">ALLOC_SLOT</a>(SEXP obj, SEXP nm, SEXPTYPE type, <span class="keywordtype">int</span> length)
00113 {
00114     SEXP val = allocVector(type, length);
00115 
00116     SET_SLOT(obj, nm, val);
00117     <span class="keywordflow">return</span> val;
00118 }
00119 
00130 <span class="keyword">static</span> R_INLINE
<a name="l00131"></a><a class="code" href="Mutils_8h.html#a50">00131</a> <span class="keywordtype">int</span>* <a class="code" href="Mutils_8h.html#a50">expand_cmprPt</a>(<span class="keywordtype">int</span> ncol, <span class="keyword">const</span> <span class="keywordtype">int</span> mp[], <span class="keywordtype">int</span> mj[])
00132 {
00133     <span class="keywordtype">int</span> j;
00134     <span class="keywordflow">for</span> (j = 0; j &lt; ncol; j++) {
00135         <span class="keywordtype">int</span> j2 = mp[j+1], jj;
00136         <span class="keywordflow">for</span> (jj = mp[j]; jj &lt; j2; jj++) mj[jj] = j;
00137     }
00138     <span class="keywordflow">return</span> mj;
00139 }
00140 
00141 
00157 <span class="keyword">static</span> R_INLINE <span class="keywordtype">int</span>
<a name="l00158"></a><a class="code" href="Mutils_8h.html#a51">00158</a> <a class="code" href="Mutils_8h.html#a51">check_csc_index</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p[], <span class="keyword">const</span> <span class="keywordtype">int</span> i[], <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col, <span class="keywordtype">int</span> missing)
00159 {
00160     <span class="keywordtype">int</span> k, k2 = p[col + 1];
00161                                 <span class="comment">/* linear search - perhaps replace by bsearch */</span>
00162     <span class="keywordflow">for</span> (k = p[col]; k &lt; k2; k++) <span class="keywordflow">if</span> (i[k] == row) <span class="keywordflow">return</span> k;
00163     <span class="keywordflow">if</span> (!missing)
00164         error(<span class="stringliteral">"row %d and column %d not defined in rowind and colptr"</span>,
00165               row, col);
00166     <span class="keywordflow">return</span> missing;
00167 }
00168 
00169 SEXP <a class="code" href="Mutils_8c.html#a22">alloc3Darray</a>(SEXPTYPE mode, <span class="keywordtype">int</span> nrow, <span class="keywordtype">int</span> ncol, <span class="keywordtype">int</span> nface);
00170 
00180 <span class="keyword">static</span> R_INLINE
<a name="l00181"></a><a class="code" href="Mutils_8h.html#a53">00181</a> <span class="keywordtype">int</span> <a class="code" href="Mutils_8h.html#a53">Lind</a>(<span class="keywordtype">int</span> k, <span class="keywordtype">int</span> i)
00182 {
00183     <span class="keywordflow">if</span> (k &lt; i) error("Lind(k = %d, i = %d) must have k &gt;= i<span class="stringliteral">", k, i);</span>
00184 <span class="stringliteral">    return (k * (k + 1))/2 + i;</span>
00185 <span class="stringliteral">}</span>
00186 <span class="stringliteral"></span>
00195 <span class="stringliteral">static R_INLINE</span>
<a name="l00196"></a><a class="code" href="Mutils_8h.html#a54">00196</a> <span class="stringliteral">int match_mat_dims(const int xd[], const int yd[])</span>
00197 <span class="stringliteral">{</span>
00198 <span class="stringliteral">    return xd[0] == yd[0] &amp;&amp; xd[1] == yd[1];</span>
00199 <span class="stringliteral">}</span>
00200 <span class="stringliteral"></span>
00201 <span class="stringliteral">double *expand_csc_column(double *dest, int m, int j,</span>
00202 <span class="stringliteral">                          const int Ap[], const int Ai[], const double Ax[]);</span>
00203 <span class="stringliteral"></span>
00211 <span class="stringliteral">static R_INLINE void</span>
<a name="l00212"></a><a class="code" href="Mutils_8h.html#a56">00212</a> <span class="stringliteral">int_permute(int i[], int n, const int perm[])</span>
00213 <span class="stringliteral">{</span>
00214 <span class="stringliteral">    int j;</span>
00215 <span class="stringliteral">    for (j = 0; j &lt; n; j++) i[j] = perm[i[j]];</span>
00216 <span class="stringliteral">}</span>
00217 <span class="stringliteral"></span>
00225 <span class="stringliteral">static R_INLINE void</span>
<a name="l00226"></a><a class="code" href="Mutils_8h.html#a57">00226</a> <span class="stringliteral">make_upper_triangular(int i[], int j[], int nnz)</span>
00227 <span class="stringliteral">{</span>
00228 <span class="stringliteral">    int k;</span>
00229 <span class="stringliteral">    for (k = 0; k &lt; nnz; k++) {</span>
00230 <span class="stringliteral">        if (i[k] &gt; j[k]) {</span>
00231 <span class="stringliteral">            int tmp = i[k];</span>
00232 <span class="stringliteral">            i[k] = j[k];</span>
00233 <span class="stringliteral">            j[k] = tmp;</span>
00234 <span class="stringliteral">        }</span>
00235 <span class="stringliteral">    }</span>
00236 <span class="stringliteral">}</span>
00237 <span class="stringliteral"></span>
00238 <span class="stringliteral">void make_array_triangular(double *x, SEXP from);</span>
00239 <span class="stringliteral"></span>
00240 <span class="stringliteral">#ifdef __cplusplus</span>
00241 <span class="stringliteral">}</span>
00242 <span class="stringliteral">#endif</span>
00243 <span class="stringliteral"></span>
00244 <span class="stringliteral">#endif /* MATRIX_MUTILS_H_ */</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Mar 30 08:43:57 2005 for Matrix by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.1 </small></address>
</body>
</html>
