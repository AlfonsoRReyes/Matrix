\hypertarget{Mutils_8c}{
\subsection{Mutils.c File Reference}
\label{Mutils_8c}\index{Mutils.c@{Mutils.c}}
}
{\tt \#include \char`\"{}Mutils.h\char`\"{}}\par
{\tt \#include \char`\"{}triplet\_\-to\_\-col.h\char`\"{}}\par
{\tt \#include $<$R\_\-ext/Lapack.h$>$}\par
\subsubsection*{Functions}
\begin{CompactItemize}
\item 
char \hyperlink{Mutils_8c_a0}{norm\_\-type} (char $\ast$typstr)
\item 
char \hyperlink{Mutils_8c_a1}{rcond\_\-type} (char $\ast$typstr)
\item 
double \hyperlink{Mutils_8c_a2}{get\_\-double\_\-by\_\-name} (SEXP obj, char $\ast$nm)
\item 
SEXP \hyperlink{Mutils_8c_a3}{set\_\-double\_\-by\_\-name} (SEXP obj, double val, char $\ast$nm)
\item 
SEXP \hyperlink{Mutils_8c_a4}{as\_\-det\_\-obj} (double val, int log, int sign)
\item 
SEXP \hyperlink{Mutils_8c_a5}{get\_\-factors} (SEXP obj, char $\ast$nm)
\item 
SEXP \hyperlink{Mutils_8c_a6}{set\_\-factors} (SEXP obj, SEXP val, char $\ast$nm)
\item 
SEXP \hyperlink{Mutils_8c_a7}{dg\-CMatrix\_\-set\_\-Dim} (SEXP x, int nrow)
\item 
int \hyperlink{Mutils_8c_a8}{csc\_\-unsorted\_\-columns} (int ncol, const int p\mbox{[}$\,$\mbox{]}, const int i\mbox{[}$\,$\mbox{]})
\item 
void \hyperlink{Mutils_8c_a9}{csc\_\-sort\_\-columns} (int ncol, const int p\mbox{[}$\,$\mbox{]}, int i\mbox{[}$\,$\mbox{]}, double x\mbox{[}$\,$\mbox{]})
\item 
SEXP \hyperlink{Mutils_8c_a10}{csc\_\-check\_\-column\_\-sorting} (SEXP m)
\item 
SEXP \hyperlink{Mutils_8c_a11}{triple\_\-as\_\-SEXP} (int nrow, int ncol, int nz, const int Ti\mbox{[}$\,$\mbox{]}, const int Tj\mbox{[}$\,$\mbox{]}, const double Tx\mbox{[}$\,$\mbox{]}, char $\ast$Rclass)
\item 
void \hyperlink{Mutils_8c_a12}{csc\_\-components\_\-transpose} (int m, int n, int nnz, const int xp\mbox{[}$\,$\mbox{]}, const int xi\mbox{[}$\,$\mbox{]}, const double xx\mbox{[}$\,$\mbox{]}, int ap\mbox{[}$\,$\mbox{]}, int ai\mbox{[}$\,$\mbox{]}, double ax\mbox{[}$\,$\mbox{]})
\item 
void \hyperlink{Mutils_8c_a13}{ssc\_\-symbolic\_\-permute} (int n, int upper, const int perm\mbox{[}$\,$\mbox{]}, int Ap\mbox{[}$\,$\mbox{]}, int Ai\mbox{[}$\,$\mbox{]})
\item 
double $\ast$ \hyperlink{Mutils_8c_a14}{nlme\_\-symmetrize} (double $\ast$a, const int nc)
\item 
void \hyperlink{Mutils_8c_a15}{nlme\_\-check\_\-Lapack\_\-error} (int info, const char $\ast$la\-Name)
\item 
SEXP \hyperlink{Mutils_8c_a16}{nlme\_\-replace\-Slot} (SEXP obj, SEXP names, SEXP value)
\item 
SEXP \hyperlink{Mutils_8c_a17}{nlme\_\-weight\_\-matrix\_\-list} (SEXP MLin, SEXP wts, SEXP adjst, SEXP MLout)
\item 
SEXP \hyperlink{Mutils_8c_a18}{Matrix\_\-make\_\-named} (int TYP, char $\ast$$\ast$names)
\item 
SEXP \hyperlink{Mutils_8c_a19}{alloc3Darray} (SEXPTYPE mode, int nrow, int ncol, int nface)
\item 
double $\ast$ \hyperlink{Mutils_8c_a20}{expand\_\-csc\_\-column} (double $\ast$dest, int m, int j, const int Ap\mbox{[}$\,$\mbox{]}, const int Ai\mbox{[}$\,$\mbox{]}, const double Ax\mbox{[}$\,$\mbox{]})
\end{CompactItemize}


\subsubsection{Function Documentation}
\hypertarget{Mutils_8c_a19}{
\index{Mutils.c@{Mutils.c}!alloc3Darray@{alloc3Darray}}
\index{alloc3Darray@{alloc3Darray}!Mutils.c@{Mutils.c}}
\paragraph[alloc3Darray]{\setlength{\rightskip}{0pt plus 5cm}SEXP alloc3Darray (SEXPTYPE {\em mode}, int {\em nrow}, int {\em ncol}, int {\em nface})}\hfill}
\label{Mutils_8c_a19}


Allocate a 3-dimensional array

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em mode}]The R mode (e.g. INTSXP) \item[{\em nrow}]number of rows \item[{\em ncol}]number of columns \item[{\em nface}]number of faces\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]A 3-dimensional array of the indicated dimensions and mode \end{Desc}
\hypertarget{Mutils_8c_a4}{
\index{Mutils.c@{Mutils.c}!as_det_obj@{as\_\-det\_\-obj}}
\index{as_det_obj@{as\_\-det\_\-obj}!Mutils.c@{Mutils.c}}
\paragraph[as\_\-det\_\-obj]{\setlength{\rightskip}{0pt plus 5cm}SEXP as\_\-det\_\-obj (double {\em val}, int {\em log}, int {\em sign})}\hfill}
\label{Mutils_8c_a4}


\hypertarget{Mutils_8c_a10}{
\index{Mutils.c@{Mutils.c}!csc_check_column_sorting@{csc\_\-check\_\-column\_\-sorting}}
\index{csc_check_column_sorting@{csc\_\-check\_\-column\_\-sorting}!Mutils.c@{Mutils.c}}
\paragraph[csc\_\-check\_\-column\_\-sorting]{\setlength{\rightskip}{0pt plus 5cm}SEXP csc\_\-check\_\-column\_\-sorting (SEXP {\em m})}\hfill}
\label{Mutils_8c_a10}


Check for sorted columns in an object that inherits from the dg\-CMatrix class. Resort the columns if necessary.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em m}]pointer to an object that inherits from the dg\-CMatrix class\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]m with the columns sorted by increasing row index \end{Desc}
\hypertarget{Mutils_8c_a12}{
\index{Mutils.c@{Mutils.c}!csc_components_transpose@{csc\_\-components\_\-transpose}}
\index{csc_components_transpose@{csc\_\-components\_\-transpose}!Mutils.c@{Mutils.c}}
\paragraph[csc\_\-components\_\-transpose]{\setlength{\rightskip}{0pt plus 5cm}void csc\_\-components\_\-transpose (int {\em m}, int {\em n}, int {\em nnz}, const int {\em xp}\mbox{[}$\,$\mbox{]}, const int {\em xi}\mbox{[}$\,$\mbox{]}, const double {\em xx}\mbox{[}$\,$\mbox{]}, int {\em ap}\mbox{[}$\,$\mbox{]}, int {\em ai}\mbox{[}$\,$\mbox{]}, double {\em ax}\mbox{[}$\,$\mbox{]})}\hfill}
\label{Mutils_8c_a12}


\hypertarget{Mutils_8c_a9}{
\index{Mutils.c@{Mutils.c}!csc_sort_columns@{csc\_\-sort\_\-columns}}
\index{csc_sort_columns@{csc\_\-sort\_\-columns}!Mutils.c@{Mutils.c}}
\paragraph[csc\_\-sort\_\-columns]{\setlength{\rightskip}{0pt plus 5cm}void csc\_\-sort\_\-columns (int {\em ncol}, const int {\em p}\mbox{[}$\,$\mbox{]}, int {\em i}\mbox{[}$\,$\mbox{]}, double {\em x}\mbox{[}$\,$\mbox{]})}\hfill}
\label{Mutils_8c_a9}


Sort the columns in a sparse column-oriented matrix so that each column is in increasing order of row index.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em ncol}]number of columns \item[{\em p}]column pointers \item[{\em i}]row indices \item[{\em x}]values of nonzero elements \end{description}
\end{Desc}
\hypertarget{Mutils_8c_a8}{
\index{Mutils.c@{Mutils.c}!csc_unsorted_columns@{csc\_\-unsorted\_\-columns}}
\index{csc_unsorted_columns@{csc\_\-unsorted\_\-columns}!Mutils.c@{Mutils.c}}
\paragraph[csc\_\-unsorted\_\-columns]{\setlength{\rightskip}{0pt plus 5cm}int csc\_\-unsorted\_\-columns (int {\em ncol}, const int {\em p}\mbox{[}$\,$\mbox{]}, const int {\em i}\mbox{[}$\,$\mbox{]})}\hfill}
\label{Mutils_8c_a8}


Check for unsorted columns in the row indices

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em ncol}]number of columns \item[{\em p}]column pointers \item[{\em i}]row indices\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]0 if all columns are sorted, otherwise 1 \end{Desc}
\hypertarget{Mutils_8c_a7}{
\index{Mutils.c@{Mutils.c}!dgCMatrix_set_Dim@{dgCMatrix\_\-set\_\-Dim}}
\index{dgCMatrix_set_Dim@{dgCMatrix\_\-set\_\-Dim}!Mutils.c@{Mutils.c}}
\paragraph[dgCMatrix\_\-set\_\-Dim]{\setlength{\rightskip}{0pt plus 5cm}SEXP dg\-CMatrix\_\-set\_\-Dim (SEXP {\em x}, int {\em nrow})}\hfill}
\label{Mutils_8c_a7}


\hypertarget{Mutils_8c_a20}{
\index{Mutils.c@{Mutils.c}!expand_csc_column@{expand\_\-csc\_\-column}}
\index{expand_csc_column@{expand\_\-csc\_\-column}!Mutils.c@{Mutils.c}}
\paragraph[expand\_\-csc\_\-column]{\setlength{\rightskip}{0pt plus 5cm}double$\ast$ expand\_\-csc\_\-column (double $\ast$ {\em dest}, int {\em m}, int {\em j}, const int {\em Ap}\mbox{[}$\,$\mbox{]}, const int {\em Ai}\mbox{[}$\,$\mbox{]}, const double {\em Ax}\mbox{[}$\,$\mbox{]})}\hfill}
\label{Mutils_8c_a20}


Expand a column of a compressed, sparse, column-oriented matrix.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em dest}]array to hold the result \item[{\em m}]number of rows in the matrix \item[{\em j}]index (0-based) of column to expand \item[{\em Ap}]array of column pointers \item[{\em Ai}]array of row indices \item[{\em Ax}]array of non-zero values\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]dest \end{Desc}
\hypertarget{Mutils_8c_a2}{
\index{Mutils.c@{Mutils.c}!get_double_by_name@{get\_\-double\_\-by\_\-name}}
\index{get_double_by_name@{get\_\-double\_\-by\_\-name}!Mutils.c@{Mutils.c}}
\paragraph[get\_\-double\_\-by\_\-name]{\setlength{\rightskip}{0pt plus 5cm}double get\_\-double\_\-by\_\-name (SEXP {\em obj}, char $\ast$ {\em nm})}\hfill}
\label{Mutils_8c_a2}


\hypertarget{Mutils_8c_a5}{
\index{Mutils.c@{Mutils.c}!get_factors@{get\_\-factors}}
\index{get_factors@{get\_\-factors}!Mutils.c@{Mutils.c}}
\paragraph[get\_\-factors]{\setlength{\rightskip}{0pt plus 5cm}SEXP get\_\-factors (SEXP {\em obj}, char $\ast$ {\em nm})}\hfill}
\label{Mutils_8c_a5}


\hypertarget{Mutils_8c_a18}{
\index{Mutils.c@{Mutils.c}!Matrix_make_named@{Matrix\_\-make\_\-named}}
\index{Matrix_make_named@{Matrix\_\-make\_\-named}!Mutils.c@{Mutils.c}}
\paragraph[Matrix\_\-make\_\-named]{\setlength{\rightskip}{0pt plus 5cm}SEXP Matrix\_\-make\_\-named (int {\em TYP}, char $\ast$$\ast$ {\em names})}\hfill}
\label{Mutils_8c_a18}


Create a named vector of type TYP

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em TYP}]a vector SEXP type (e.g. REALSXP) \item[{\em names}]names of list elements with null string appended\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]pointer to a named vector of type TYP \end{Desc}
\hypertarget{Mutils_8c_a15}{
\index{Mutils.c@{Mutils.c}!nlme_check_Lapack_error@{nlme\_\-check\_\-Lapack\_\-error}}
\index{nlme_check_Lapack_error@{nlme\_\-check\_\-Lapack\_\-error}!Mutils.c@{Mutils.c}}
\paragraph[nlme\_\-check\_\-Lapack\_\-error]{\setlength{\rightskip}{0pt plus 5cm}void nlme\_\-check\_\-Lapack\_\-error (int {\em info}, const char $\ast$ {\em la\-Name})}\hfill}
\label{Mutils_8c_a15}


Check the error code returned by an Lapack routine and create an appropriate error message.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em info}]Error code as returned from the Lapack routine \item[{\em la\-Name}]Character string containing the name of the Lapack routine \end{description}
\end{Desc}
\hypertarget{Mutils_8c_a16}{
\index{Mutils.c@{Mutils.c}!nlme_replaceSlot@{nlme\_\-replaceSlot}}
\index{nlme_replaceSlot@{nlme\_\-replaceSlot}!Mutils.c@{Mutils.c}}
\paragraph[nlme\_\-replaceSlot]{\setlength{\rightskip}{0pt plus 5cm}SEXP nlme\_\-replace\-Slot (SEXP {\em obj}, SEXP {\em names}, SEXP {\em value})}\hfill}
\label{Mutils_8c_a16}


Replace the value of a slot or subslot of an object in place. This routine purposely does not copy the value of obj. Use with caution.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em obj}]object with slot to be replaced \item[{\em names}]vector of names. The last element is the name of the slot to replace. The leading elements are the names of slots and subslots of obj. \item[{\em value}]the replacement value for the slot\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]obj, with the named slot modified in place. \end{Desc}
\hypertarget{Mutils_8c_a14}{
\index{Mutils.c@{Mutils.c}!nlme_symmetrize@{nlme\_\-symmetrize}}
\index{nlme_symmetrize@{nlme\_\-symmetrize}!Mutils.c@{Mutils.c}}
\paragraph[nlme\_\-symmetrize]{\setlength{\rightskip}{0pt plus 5cm}double$\ast$ nlme\_\-symmetrize (double $\ast$ {\em a}, const int {\em nc})}\hfill}
\label{Mutils_8c_a14}


Symmetrize a matrix by copying the strict upper triangle into the lower triangle.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em a}]pointer to a matrix in Fortran storage mode \item[{\em nc}]number of columns (and rows and leading dimension) in the matrix\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]a, symmetrized \end{Desc}
\hypertarget{Mutils_8c_a17}{
\index{Mutils.c@{Mutils.c}!nlme_weight_matrix_list@{nlme\_\-weight\_\-matrix\_\-list}}
\index{nlme_weight_matrix_list@{nlme\_\-weight\_\-matrix\_\-list}!Mutils.c@{Mutils.c}}
\paragraph[nlme\_\-weight\_\-matrix\_\-list]{\setlength{\rightskip}{0pt plus 5cm}SEXP nlme\_\-weight\_\-matrix\_\-list (SEXP {\em MLin}, SEXP {\em wts}, SEXP {\em adjst}, SEXP {\em MLout})}\hfill}
\label{Mutils_8c_a17}


Produce a weighted copy of the matrices in MLin in the storage allocated to MLout

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em MLin}]input matrix list \item[{\em wts}]real vector of weights \item[{\em adjst}]adjusted response \item[{\em MLout}]On input a list of matrices of the same dimensions as MLin.\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]MLout with its contents overwritten by a weighted copy of MLin according to wts with adjst overwriting the response. \end{Desc}
\hypertarget{Mutils_8c_a0}{
\index{Mutils.c@{Mutils.c}!norm_type@{norm\_\-type}}
\index{norm_type@{norm\_\-type}!Mutils.c@{Mutils.c}}
\paragraph[norm\_\-type]{\setlength{\rightskip}{0pt plus 5cm}char norm\_\-type (char $\ast$ {\em typstr})}\hfill}
\label{Mutils_8c_a0}


\hypertarget{Mutils_8c_a1}{
\index{Mutils.c@{Mutils.c}!rcond_type@{rcond\_\-type}}
\index{rcond_type@{rcond\_\-type}!Mutils.c@{Mutils.c}}
\paragraph[rcond\_\-type]{\setlength{\rightskip}{0pt plus 5cm}char rcond\_\-type (char $\ast$ {\em typstr})}\hfill}
\label{Mutils_8c_a1}


\hypertarget{Mutils_8c_a3}{
\index{Mutils.c@{Mutils.c}!set_double_by_name@{set\_\-double\_\-by\_\-name}}
\index{set_double_by_name@{set\_\-double\_\-by\_\-name}!Mutils.c@{Mutils.c}}
\paragraph[set\_\-double\_\-by\_\-name]{\setlength{\rightskip}{0pt plus 5cm}SEXP set\_\-double\_\-by\_\-name (SEXP {\em obj}, double {\em val}, char $\ast$ {\em nm})}\hfill}
\label{Mutils_8c_a3}


\hypertarget{Mutils_8c_a6}{
\index{Mutils.c@{Mutils.c}!set_factors@{set\_\-factors}}
\index{set_factors@{set\_\-factors}!Mutils.c@{Mutils.c}}
\paragraph[set\_\-factors]{\setlength{\rightskip}{0pt plus 5cm}SEXP set\_\-factors (SEXP {\em obj}, SEXP {\em val}, char $\ast$ {\em nm})}\hfill}
\label{Mutils_8c_a6}


\hypertarget{Mutils_8c_a13}{
\index{Mutils.c@{Mutils.c}!ssc_symbolic_permute@{ssc\_\-symbolic\_\-permute}}
\index{ssc_symbolic_permute@{ssc\_\-symbolic\_\-permute}!Mutils.c@{Mutils.c}}
\paragraph[ssc\_\-symbolic\_\-permute]{\setlength{\rightskip}{0pt plus 5cm}void ssc\_\-symbolic\_\-permute (int {\em n}, int {\em upper}, const int {\em perm}\mbox{[}$\,$\mbox{]}, int {\em Ap}\mbox{[}$\,$\mbox{]}, int {\em Ai}\mbox{[}$\,$\mbox{]})}\hfill}
\label{Mutils_8c_a13}


\hypertarget{Mutils_8c_a11}{
\index{Mutils.c@{Mutils.c}!triple_as_SEXP@{triple\_\-as\_\-SEXP}}
\index{triple_as_SEXP@{triple\_\-as\_\-SEXP}!Mutils.c@{Mutils.c}}
\paragraph[triple\_\-as\_\-SEXP]{\setlength{\rightskip}{0pt plus 5cm}SEXP triple\_\-as\_\-SEXP (int {\em nrow}, int {\em ncol}, int {\em nz}, const int {\em Ti}\mbox{[}$\,$\mbox{]}, const int {\em Tj}\mbox{[}$\,$\mbox{]}, const double {\em Tx}\mbox{[}$\,$\mbox{]}, char $\ast$ {\em Rclass})}\hfill}
\label{Mutils_8c_a11}


